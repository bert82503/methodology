

如何进行高效的代码审查
======

这篇文章详细讨论了**如何进行高效的代码审查**，包括**作者和审查者应遵循的指导原则**。文章强调了尊重审查者的时间，自我审查代码，将大的更改列表分解为小的、逻辑上的单元，自动化简单的任务，限制代码更改的范围，优雅地接受批评，最小化审查回合之间的延迟，明确地沟通响应，不忘记文档等。同时，**审查者**也需要验证**代码是否必要、设计得当，是否易读、清晰**，**注释是否解释了“为什么”** 而不是“做什么”，**代码是否过于复杂，是否遵循风格指南，是否经过充分的测试和文档记录**等，对代码审查实战具有极大的参考价值。

> 原文链接：[https://addyosmani.com/blog/code-reviews/](https://addyosmani.com/blog/code-reviews/)

**代码审查是作者和审查者共同学习、分享知识并提升软件质量的有效途径**。它是我们走向卓越的一条必经之路。以下是有助于让作者和审查者以**更高效、更建设性**的方式来进行代码审查的一些建议。


## 尊重审查者的时间
在高效的代码审查过程中，尊重审查者的时间至关重要。

这里有一些面向作者的建议：

### 对自己的代码进行自我审查
在将代码提交审查之前，你应该先自己检查一遍代码。找出拼写错误、逻辑错误以及需要改进的地方。这样的初步审查可以帮助你在审查者介入之前就发现并改正一些小问题。

### 将大的变更拆分成小的变更
审查小而可管理的代码块比审查大块的代码更为容易、更为高效。通过**将修改内容分解为更小、逻辑清晰的部分**，这样可以让审查过程更顺畅，也可以减轻审查者的压力。

### 自动化简单的任务
尽可能利用现有工具来自动化如 linting （一个代码检查过程，用于查找源代码中的错误并标记潜在的错误）和格式化的任务。这样，你可以节省审查者的时间，并确保你的代码符合团队的标准，无需人工干预。这种方式通常需要在团队或项目层面预先进行协调。

### 缩小变更的范围
你的代码**变更**应该尽可能地**具体和紧凑**。包含无关的变更会让审查者难以理解，增大漏过错误的机会。

### 积极接受批评
你应对建设性的批评保持**开放的态度，并视其为学习的机会**。每个人都会犯错误，我们可以借助代码审查从错误中学习。

### 减少审查回合之间的延迟
及时回应审查评论可以帮助保持**审查流程的连续性**，减少每次审查所花费的时间。

### 主动寻求缺失的信息
如果你对某件事情感到**不确定**，应该**主动进行积极的对话**，以便让作者或审阅者得到**更多的信息或解释**。**建设性的对话**可以让作者和审查者都有所收获。

### 清晰地传达反馈
始终要**清晰地传达你的改动**。即使你已经根据审查者的建议进行了修改，也应明确地告知对方。

### 不要忘记编写文档
**良好的文档和代码本身同样重要**。**文档提供了上下文，解释了代码为何以及如何工作**，这使得其他人更容易理解你的代码。同样，对于其他期望的项目部分，如测试，也应编写相应的文档。


## 审查者的职责：验证代码是否...
### 必需且设计合理
在审查代码时，你需要**验证代码是否真正必要，以及是否可以与现有的代码库兼容**。所有的代码部分都应该能与系统的其他部分顺畅地交互，共同提升系统的整体功能。

### 易于阅读且目标明确
**代码应清晰易懂，目标明确**，这不仅对最终用户有益，对未来的维护者也是如此。

### 注释以“为什么”为主，而非“做了什么”
**注释应解释代码存在的理由**，而非它在做什么。遵循这个原则有助于**理解代码背后的思想和设计**。

### 尽量避免编写过于复杂的代码
**复杂的代码更难维护，更容易出错**。因此，代码应该尽可能地简洁，同时又能实现所需的功能。

### 遵循样式指南（Style Guide）
代码应遵循团队的编程样式指南。所有主要的样式修改应该与主要的变更列表分开进行。

### 充分测试且配有详细的文档说明
代码应配有适当的测试，并且有详尽的文档描述。这种做法有助于保持代码的完整性，并帮助其他人更好地理解它。


## 保证代码审查的建设性
**评论要针对代码**，而非开发者。评价编程技能不应作为代码审查的环节。应避免轻率或含糊的评论，反之，**评论应清晰、具体，并适当地给出积极反馈**。尽可能避免过度苛求细节，让自动化的样式检查来处理微小问题。


## 标准很多，需要抓重点
在审查代码的过程中，需要考虑的**关键标准**包括：**代码是否满足需求、逻辑是否正确和安全、性能、健壮性和可观察性如何**、**是否存在不必要的复杂性、API 和内部结构是否清晰**以及**是否引入了破坏性的变更**。


总的来说，**代码审查应当是尊重的、有建设性的，并且聚焦的**。作者和审查者在保证**代码质量以及确保其长期可维护性**方面都扮演着关键角色。记住要**保持开放的心态，并始终致力于提升自我**。祝你审查愉快！


您在代码审查实践过程中还有其他经验吗？欢迎在评论区分享您的观点和建议。

